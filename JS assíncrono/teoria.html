<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JS assíncrono</title>
</head>
<body>
    
</body>
</html>
<script>
    //Callback - Uma função que é passada como argumento em outra função.
    function greeting(name){
        alert('Olá' + name);
    }

    function processUserInput(callback){
        var name = prompt('Por favor, digite seu nome.');
        callback(name);
    }
    processUserInput(greeting);
    //Promises - São objetos que representam a eventual conclusão ou falha de uma operação
    //assíncrone
    let promise = new Promise ((resolve, reject)=>{
        let condition = true;

        if(condition){
            resolve('Prromise resolvida');
        } else{
            reject('Operação falhou');
        }
    })
    .then((message)=>{
        console.log(message);
    })

    .catch((error)=>{
        console.log(error);
    })

    //Exemplo de operação encadeada
    getData()
    .then(data=>getMoreData(data))
    .then(moreData=>(console.log(moreData)))
    .catch(error => console.log(error))

    //Async/Await - É uma forma de escrever código assíncrono de forma mais clara
    async function minhaFuncao(){
        try{
            const resultado = await algumaFuncaoAssincrona();
            console.log(resultado);
        } catch(erro){
            console.log(erro);
        }
    }

    //Fazendo requisições com Fetch API
    fetch('https://api.meusite.com/dados')
    .then(resposta => resposta.json())
    .then(dados => console.log(dados))
    .catch(erro => console.log('Erro',erro))

    //Exemplo requisição POST
    const dadosParaEnviar = {nome:'João', idade:30};
    fetch('https://api.meusite.com/dados',{
        method:'POST',
        headers: {
            'Content-Type':'application/json'
        },
        body: JSON.stringify(dadosParaEnviar)
    })
    .then(resposta => resposta.json())
    .then(dados => console.log(dados))
    .catch(erro => console.log('Erro', erro))

    //Realizando request em API real
    //Método GET
    fetch('https://jsonplaceholder.typicode.com/posts')
    .then(resposta => resposta.json())
    .then(dados => console.log(dados))
    .catch(erro => console.log('Erro', erro))

    //Método POST
    const novaPostagem = {
        title: 'Nova Postagem',
        body: 'Corpo da nova postagem',
        userId: 1
    }
    fetch('https://jsonplaceholder.typicode.com/posts',{
        method: 'POST',
        headers: {
            'Content-Type': 'application/json'
        },
        body: JSON.stringify(novaPostagem)
    })
    .then(resposta => resposta.json())
    .then(dados => console.log(dados))
    .catch(erro => console.log('Erro', erro))
</script>